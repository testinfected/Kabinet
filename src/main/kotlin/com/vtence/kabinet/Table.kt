package com.vtence.kabinet

open class Table(name: String) {
    val tableName = name
    private val columns = mutableListOf<Column<*>>()

    fun columnNames(includeAutoGenerated: Boolean): List<String> = columns(includeAutoGenerated).map { it.name }

    private fun columns(includeAutoGenerated: Boolean): List<Column<*>> {
        return columns.filter { !it.autoGenerated || includeAutoGenerated }
    }

    fun int(name: String): Column<Int> = add(Column(this, name))

    fun string(name: String): Column<String> = add(Column(this, name))

    private fun <T> add(column: Column<T>): Column<T> {
        columns += column
        return column
    }

    fun replaceColumn(column: Column<*>, with: Column<*>) {
        columns.remove(column)
        columns.add(with)
    }
}
